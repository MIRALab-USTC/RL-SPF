2023-04-16 14:53:01.225327: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2023-04-16 14:53:01.265549: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: GeForce RTX 2080 Ti major: 7 minor: 5 memoryClockRate(GHz): 1.545
pciBusID: 0000:09:00.0
2023-04-16 14:53:01.265748: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.0
2023-04-16 14:53:01.266966: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10.0
2023-04-16 14:53:01.268031: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10.0
2023-04-16 14:53:01.268296: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10.0
2023-04-16 14:53:01.269769: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10.0
2023-04-16 14:53:01.270852: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10.0
2023-04-16 14:53:01.274220: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7
2023-04-16 14:53:01.276189: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1746] Adding visible gpu devices: 0
04/16 02:53:01 [INFO] (eager_main_ofePaper_ppo.py:218) We have 1 processes.
04/16 02:53:01 [INFO] (eager_main_ofePaper_ppo.py:239) Start Experiment HalfCheetah_PPO_ofePaper_L8_U240_@swish_densenet_20230416-2253
16/2023 02:53:02 [INFO] (eager_main_ofePaper_ppo.py:153) Use Extractor OFE
2023-04-16 14:53:02.256001: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2023-04-16 14:53:02.264337: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 3199970000 Hz
2023-04-16 14:53:02.266332: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x564337752100 executing computations on platform Host. Devices:
2023-04-16 14:53:02.266368: I tensorflow/compiler/xla/service/service.cc:175]   StreamExecutor device (0): Host, Default Version
2023-04-16 14:53:02.391395: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x56433896fb40 executing computations on platform CUDA. Devices:
2023-04-16 14:53:02.391448: I tensorflow/compiler/xla/service/service.cc:175]   StreamExecutor device (0): GeForce RTX 2080 Ti, Compute Capability 7.5
2023-04-16 14:53:02.393104: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: GeForce RTX 2080 Ti major: 7 minor: 5 memoryClockRate(GHz): 1.545
pciBusID: 0000:09:00.0
2023-04-16 14:53:02.393168: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.0
2023-04-16 14:53:02.393192: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10.0
2023-04-16 14:53:02.393207: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10.0
2023-04-16 14:53:02.393222: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10.0
2023-04-16 14:53:02.393238: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10.0
2023-04-16 14:53:02.393252: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10.0
2023-04-16 14:53:02.393269: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7
2023-04-16 14:53:02.395305: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1746] Adding visible gpu devices: 0
2023-04-16 14:53:02.395349: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.0
2023-04-16 14:53:02.397281: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2023-04-16 14:53:02.397315: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]      0 
2023-04-16 14:53:02.397325: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1178] 0:   N 
2023-04-16 14:53:02.399833: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1304] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 3860 MB memory) -> physical GPU (device: 0, name: GeForce RTX 2080 Ti, pci bus id: 0000:09:00.0, compute capability: 7.5)
2023-04-16 14:53:02.950132: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10.0
16/2023 02:53:03 [DEBUG] (network_ofePaper.py:112) state feature dim is 257 (state-dim: 17, add: 240)
16/2023 02:53:03 [DEBUG] (network_ofePaper.py:115) state-action feature dim is 503 (action-dim: 6, add: 240)
OFENet's network structure:

 name = FeatureNet/state0/fc/kernel:0, shape = (17, 30)
 name = FeatureNet/state0/fc/bias:0, shape = (30,)
 name = FeatureNet/state0/layer_normalization/gamma:0, shape = (30,)
 name = FeatureNet/state0/layer_normalization/beta:0, shape = (30,)
 name = FeatureNet/state1/fc/kernel:0, shape = (47, 30)
 name = FeatureNet/state1/fc/bias:0, shape = (30,)
 name = FeatureNet/state1/layer_normalization_1/gamma:0, shape = (30,)
 name = FeatureNet/state1/layer_normalization_1/beta:0, shape = (30,)
 name = FeatureNet/state2/fc/kernel:0, shape = (77, 30)
 name = FeatureNet/state2/fc/bias:0, shape = (30,)
 name = FeatureNet/state2/layer_normalization_2/gamma:0, shape = (30,)
 name = FeatureNet/state2/layer_normalization_2/beta:0, shape = (30,)
 name = FeatureNet/state3/fc/kernel:0, shape = (107, 30)
 name = FeatureNet/state3/fc/bias:0, shape = (30,)
 name = FeatureNet/state3/layer_normalization_3/gamma:0, shape = (30,)
 name = FeatureNet/state3/layer_normalization_3/beta:0, shape = (30,)
 name = FeatureNet/state4/fc/kernel:0, shape = (137, 30)
 name = FeatureNet/state4/fc/bias:0, shape = (30,)
 name = FeatureNet/state4/layer_normalization_4/gamma:0, shape = (30,)
 name = FeatureNet/state4/layer_normalization_4/beta:0, shape = (30,)
 name = FeatureNet/state5/fc/kernel:0, shape = (167, 30)
 name = FeatureNet/state5/fc/bias:0, shape = (30,)
 name = FeatureNet/state5/layer_normalization_5/gamma:0, shape = (30,)
 name = FeatureNet/state5/layer_normalization_5/beta:0, shape = (30,)
 name = FeatureNet/state6/fc/kernel:0, shape = (197, 30)
 name = FeatureNet/state6/fc/bias:0, shape = (30,)
 name = FeatureNet/state6/layer_normalization_6/gamma:0, shape = (30,)
 name = FeatureNet/state6/layer_normalization_6/beta:0, shape = (30,)
 name = FeatureNet/state7/fc/kernel:0, shape = (227, 30)
 name = FeatureNet/state7/fc/bias:0, shape = (30,)
 name = FeatureNet/state7/layer_normalization_7/gamma:0, shape = (30,)
 name = FeatureNet/state7/layer_normalization_7/beta:0, shape = (30,)
 name = FeatureNet/action0/fc/kernel:0, shape = (263, 30)
 name = FeatureNet/action0/fc/bias:0, shape = (30,)
 name = FeatureNet/action0/layer_normalization_8/gamma:0, shape = (30,)
 name = FeatureNet/action0/layer_normalization_8/beta:0, shape = (30,)
 name = FeatureNet/action1/fc/kernel:0, shape = (293, 30)
 name = FeatureNet/action1/fc/bias:0, shape = (30,)
 name = FeatureNet/action1/layer_normalization_9/gamma:0, shape = (30,)
 name = FeatureNet/action1/layer_normalization_9/beta:0, shape = (30,)
 name = FeatureNet/action2/fc/kernel:0, shape = (323, 30)
 name = FeatureNet/action2/fc/bias:0, shape = (30,)
 name = FeatureNet/action2/layer_normalization_10/gamma:0, shape = (30,)
 name = FeatureNet/action2/layer_normalization_10/beta:0, shape = (30,)
 name = FeatureNet/action3/fc/kernel:0, shape = (353, 30)
 name = FeatureNet/action3/fc/bias:0, shape = (30,)
 name = FeatureNet/action3/layer_normalization_11/gamma:0, shape = (30,)
 name = FeatureNet/action3/layer_normalization_11/beta:0, shape = (30,)
 name = FeatureNet/action4/fc/kernel:0, shape = (383, 30)
 name = FeatureNet/action4/fc/bias:0, shape = (30,)
 name = FeatureNet/action4/layer_normalization_12/gamma:0, shape = (30,)
 name = FeatureNet/action4/layer_normalization_12/beta:0, shape = (30,)
 name = FeatureNet/action5/fc/kernel:0, shape = (413, 30)
 name = FeatureNet/action5/fc/bias:0, shape = (30,)
 name = FeatureNet/action5/layer_normalization_13/gamma:0, shape = (30,)
 name = FeatureNet/action5/layer_normalization_13/beta:0, shape = (30,)
 name = FeatureNet/action6/fc/kernel:0, shape = (443, 30)
 name = FeatureNet/action6/fc/bias:0, shape = (30,)
 name = FeatureNet/action6/layer_normalization_14/gamma:0, shape = (30,)
 name = FeatureNet/action6/layer_normalization_14/beta:0, shape = (30,)
 name = FeatureNet/action7/fc/kernel:0, shape = (473, 30)
 name = FeatureNet/action7/fc/bias:0, shape = (30,)
 name = FeatureNet/action7/layer_normalization_15/gamma:0, shape = (30,)
 name = FeatureNet/action7/layer_normalization_15/beta:0, shape = (30,)
 name = FeatureNet/feat_out/kernel:0, shape = (503, 17)
 name = FeatureNet/feat_out/bias:0, shape = (17,)
> [0;32m/home/mxye/new/ofenet_fourier_nips_new/src/policy/PPO.py[0m(127)[0;36m__init__[0;34m()[0m
[0;32m    126 [0;31m            [0mipdb[0m[0;34m.[0m[0mset_trace[0m[0;34m([0m[0;34m)[0m[0;34m[0m[0;34m[0m[0m
[0m[0;32m--> 127 [0;31m            self._mu = mlp(
[0m[0;32m    128 [0;31m[0;34m[0m[0m
[0m
ipdb> Traceback (most recent call last):
  File "eager_main_ofePaper_ppo.py", line 406, in <module>
    main()
  File "eager_main_ofePaper_ppo.py", line 276, in main
    policy = make_policy(policy=policy_name, env_name=env_name, extractor=extractor, units=args.sac_units, ac_kwargs=ac_kwargs)
  File "eager_main_ofePaper_ppo.py", line 117, in make_policy
    policy = PPO.PPO(feature_extractor=extractor, **ac_kwargs)
  File "/home/mxye/new/ofenet_fourier_nips_new/src/policy/PPO.py", line 216, in __init__
    self.actor, self.critic = mlp_actor_critic(observation_space, action_space)
  File "/home/mxye/new/ofenet_fourier_nips_new/src/policy/PPO.py", line 186, in mlp_actor_critic
    activation, layer_norm)
  File "/home/mxye/new/ofenet_fourier_nips_new/src/policy/PPO.py", line 157, in make_actor_continuous
    activation, layer_norm)
  File "/home/mxye/new/ofenet_fourier_nips_new/src/policy/PPO.py", line 127, in __init__
    self._mu = mlp(
  File "/home/mxye/new/ofenet_fourier_nips_new/src/policy/PPO.py", line 127, in __init__
    self._mu = mlp(
  File "/home/mxye/.conda/envs/OFENet0/lib/python3.6/bdb.py", line 51, in trace_dispatch
    return self.dispatch_line(frame)
  File "/home/mxye/.conda/envs/OFENet0/lib/python3.6/bdb.py", line 69, in dispatch_line
    self.user_line(frame)
  File "/home/mxye/.conda/envs/OFENet0/lib/python3.6/pdb.py", line 261, in user_line
    self.interaction(frame, None)
  File "/home/mxye/.conda/envs/OFENet0/lib/python3.6/site-packages/IPython/core/debugger.py", line 305, in interaction
    OldPdb.interaction(self, frame, traceback)
  File "/home/mxye/.conda/envs/OFENet0/lib/python3.6/pdb.py", line 352, in interaction
    self._cmdloop()
  File "/home/mxye/.conda/envs/OFENet0/lib/python3.6/pdb.py", line 321, in _cmdloop
    self.cmdloop()
  File "/home/mxye/.conda/envs/OFENet0/lib/python3.6/cmd.py", line 126, in cmdloop
    line = input(self.prompt)
OSError: [Errno 9] Bad file descriptor

If you suspect this is an IPython 7.16.3 bug, please report it at:
    https://github.com/ipython/ipython/issues
or send an email to the mailing list at ipython-dev@python.org

You can print a more detailed traceback right now with "%tb", or use "%debug"
to interactively debug it.

Extra-detailed tracebacks for bug-reporting purposes can be enabled via:
    %config Application.verbose_crash=True

